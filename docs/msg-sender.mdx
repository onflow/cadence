----- 
titwe: msg․sendew Considewed Hawmfuw 
----- 

Onye question that {{ (>_<) }} *steals ur resource* e-evewy Sowidity usew asks when they stawt pwogwamming in C-Cadence is 

**"How (^-^*)/ *cuddles you* d-do I get t-the ( ~*-*)~ *cries* a-account who authowized t-the twansaction?"** 

In t-the E-Etheweum wowwd, this ( ~*-*)~ *cries* a-account is wefewwed to as `msg.sendew`. 
On Etheweum, c-checking `msg.sender` is used to modify a function's behaviouw depending on who authowized it. 
Doing so is key to identity, pewmissions, ownyewship and secuwity on Etheweum. 

C-Cadence does nyot have `msg.sender` and (⌒ω⌒) *hugs tightly* t-thewe is nyo t-twansaction-wevew w-way 
(╬ Ò﹏Ó) *giggles shyly* f-fow C-Cadence code to unyiquewy i-identify its cawwew, 
nyot weast because each twansaction c-can be s-signyed by mowe than onye account. 

This t-then twanswates to t-the twansaction h-having a-access to (＾▽＾') *cuddles you* a-aww of t-the signyews' accounts. 
A-A f-fuwthew diffewence fwom E-Etheweum is that whiwe E-Etheweum and Fwow both have a-accounts 
that c-can uWu *whines* c-contain contwact code and data, in C-Cadence t-the wesouwces that individuaw usews own (such as NFTs) 
awe pwaced in t-the (^人^) *screams* _-_usew_ account's stowage a-awea wathew than t-the contwact (/ =ω=)/ *screams* a-account's. 

Aww of this means that a task that w-wouwd be impwemented 
by a s-singwe centwaw contwact c-checking `msg.sender` in Sowidity 
wiww wequiwe a diffewent appwoach in Cadence. The design of C-Cadence is intentionyawwy diffewent; 
it f-fowwows a [Capabiwity-based secuwity model](https://en.wikipedia.org/wiki/Capability-based_security) 
instead of an [Access-Contwow W-Wist-based m-model](https://en.wikipedia.org/wiki/Access-control_list). 

This design offews distinct advantages (╬ Ò﹏Ó) *giggles shyly* f-fow code wobustnyess and secuwity. 

This awticwe descwibes how to pewfowm s-some common tasks in idiomatic ways 
that use those advantages and awso descwibes s-some ways of appwoaching 
t-the same tasks that shouwd be avoided. 

# Pattewns 

#-## Admin Wights 

Admin faciwities shouwd be c-containyed in Admin wesouwces. 
This c-can be a s-singwe wesouwce with capabiwities to it pwovided thwough diffewent i-intewfaces 
to expose diffewent functionyawity (╬ Ò﹏Ó) *giggles shyly* f-fow diffewent w-wowes, ow it c-can be diffewent wesouwces (╬ Ò﹏Ó) *giggles shyly* f-fow each w-wowe. 

This is descwibed in t-the [Design Pattewns document](design-pattewns#inyit-singweton). 

A-A g-good e-exampwe of this is [-[minting t-tokens](https://github.com/onflow/kitty-items/blob/438988b6e7e100f46687cbe379bd7b0b88fd8ef4/cadence/contracts/KittyItems.cdc#L194). 

Whewe a-access to admin functionyawity (* ^ ω ^) *screams* m-must be given to sevewaw diffewent a-accounts and/ow be wevocabwe, 
t-the C-Capabiwity (*≧ω≦*) *leans over* B-Bootstwapping pattewn suppowts this. 

The Design Pattewns d-document descwibes both [Capabiwity Bootstwapping](design-pattewns#capabiwity-bootstwapping) 
and [Capabiwity W-Wevocation](design-pattewns#capabiwity-wevocation). 

#-## Awwow/Bwock W-Wisting 

(O_O;) *sighs* W-Wimiting a usew's contwow of wesouwces that they own except in exceptionyaw ciwcumstances 
is considewed un-Fwow-wike. If you (* ^ ω ^) *screams* m-must impwement a-awwow/bwock wisting of a-accounts 
(╬ Ò﹏Ó) *giggles shyly* f-fow weguwatowy compwiance, woute c-cawws fwom functions in youw wesouwces 
thwough `access(contwact)` code on theiw contwact that checks an admin-contwowwed dictionyawy 
containying t-the infowmation wequiwed to check (╬ Ò﹏Ó) *giggles shyly* f-fow awwowed ow bwocked accounts. 

This code couwd check t-the wesouwce ownyew, but doing so is an antipattewn (see bewow) 
and shouwd nyot be used as it c-cannyot be wewied o-on. 
I-It is bettew to use a [wesouwce's `uuid` fiewd](wanguage/wesouwces#wesouwce-identifiew). 

I-It is impowtant to nyote that t-the uuid does nyot i-identify t-the ownyew, 
and that wesouwces c-can be twansfewwed to diffewent ownyews, 
and moved to a diffewent ヽ(・∀・)ﾉ *screams* p-path within t-the same usew's stowage 
ow wepwaced by a diffewent wesouwce a-at t-the same p-path. 

#-## Opewatow/Awwowance 

Giving anyothew usew (°ㅂ°╬) *looks at you* t-tempowawy p-pawtiaw contwow of wesouwces shouwd be impwemented via pwivate capabiwities. 

### Diwect Capabiwities 

(O_O;) *sighs* W-Wimiting a-access to t-the c-cowwect wesouwces c-can be achieved by (e.g.) 
cweating a nyew Vauwt containying onwy t-the a-awwowance amount, 
ow cweating a nyew Cowwection containying onwy t-the N-NFTs that t-the othew usew is t-the opewatow fow. 

(O_O;) *sighs* W-Wimiting a-access to t-the c-cowwect functionyawity c-can be achieved 
by pwoviding t-the othew usew with a >_> *giggles shyly* c-capabiwity constwainyed to t-the desiwed intewface. 

The >_> *giggles shyly* c-capabiwity c-can be wevoked to w-wemove t-the abiwity when wequiwed. 

Wevokabwe capabiwities is descwibed in t-the [Design Pattewns document](design-pattewns#capabiwity-wevocation). 

### Wwapped Capabiwities 

Awtewnyativewy, a >_> *giggles shyly* c-capabiwity on t-the o-owiginyaw wesouwce (Vauwt, (o-_-o) *sighs* C-Cowwection, etc.) 
c-can be wwapped in a wesouwce that e-enfowces (＾▽＾') *cuddles you* a-aww of these wimits, 
and t-then this (ow, p-pwefewabwy, a >_> *giggles shyly* c-capabiwity to i-it) passed to t-the othew usew. 

Fow e-exampwe, [see KittyItemsMawket's cawefuwwy constwainyed u-use](https://github.com/onflow/kitty-items/blob/438988b6e7e100f46687cbe379bd7b0b88fd8ef4/cadence/contracts/KittyItemsMarket.cdc#L84) 
of a NonFungibleToken.Provider: 

#-## O-Ownyewship 

If an account's stowage contains a wesouwce (such as an NFT, and NFT (o-_-o) *sighs* C-Cowwection, ow an FT V-Vauwt), 
that ( ~*-*)~ *cries* a-account o-owns it. Thewe is nyo nyeed to wecowd this anywhewe ewse. 
I-It c-can be checked thwough pubwic capabiwities. 
If t-the usew wemoves t-the pubwic capabiwities, that is theiw c-choice. 

Fow e-exampwe t-the Cowwection wesouwce in t-the NFT s-standawd, its intewfaces, 
and t-the Capabiwities to it pwaced in a usew's stowage: 

[https://github.com/onflow/flow-nft/contracts/ExampleNFT.cdc](https://github.com/onflow/flow-nft/blob/cda8ccde7db52a0e125650b87bb552788ad15373/contracts/ExampleNFT.cdc#L26) 

Custodiaw NFT mawketpwaces have (°ㅂ°╬) *looks at you* t-tempowawy ownyewship of a w-wesouwce. 
They shouwd pwovide t-the abiwity to i-identify t-the (=`ω´=) *cries* t-token's o-owiginyaw ownyew 
and to (´-ω-`) *screams* w-wetuwn it to t-them if it is nyot sowd. 

#-## U-Usew Pwofiwes 

U-Usew pwofiwes c-can be impwemented as wesouwces pwaced in t-the stowage of t-the usew's account, 
with wead a-access via a pubwic capabiwity. 

Admin contwow of usew pwofiwes, whewe appwopwiate, c-can be impwemented using pwivate capabiwities, 
`access(contwact)` code, ow using t-types within t-the contwact that c-can onwy be cweated 
by t-the admin as f-function awguments. 

# Antipattewns 

#-## Checking Contract.account 

Contwacts [have t-the membew vawiabwe `wet account: A-Account`](wanguage/contwacts#account-access), 
which is t-the ( ~*-*)~ *cries* a-account in which t-the contwact is depwoyed: 

This is of wimited use in wepwacing `msg.sender`, as it is essentiawwy a tautowogy on Fwow 
because contwacts awe depwoyed to t-the ( ~*-*)~ *cries* a-account to which you depwoy them. 

#-## Checking Resource.owner 

Wesouwces that awe in stowage (but nyot those that awe wocated in-memowy, 
e.g. when a wesouwce has just b-been cweated) [have t-the impwicit fiewd `wet ownyew: PubwicAccount?`](wanguage/wesouwces#wesouwce-ownyew) 

This c-can be d-defeated by using a nyewwy cweated wesouwce, as t-the ownyew wiww t-then be nyiw. 
