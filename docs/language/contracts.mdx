----- 
titwe: Contwacts 
----- 

A-A contwact in C-Cadence is a cowwection of t-type definyitions 
of intewfaces, s-stwucts, wesouwces, data (its state), and code (its f-functions) 
that wives in t-the contwact stowage a-awea of an ( ~*-*)~ *cries* a-account in Fwow. 

Contwacts awe whewe (Ôºæ‚ñΩÔºæ') *cuddles you* a-aww composite t-types w-wike s-stwucts, wesouwces, 
events, and i-intewfaces (‚ï¨ √íÔπè√ì) *giggles shyly* f-fow these t-types in C-Cadence have to be definyed. 
Thewefowe, an object of onye of these t-types c-cannyot exist 
without h-having b-been definyed in a depwoyed C-Cadence contwact. 

Contwacts c-can be cweated, updated, and w-wemoved using t-the `contwacts` 
object of [authowized accounts](accounts). 
This functionyawity is covewed in t-the [-[nyext (o_O) *pokes you* s-section](#depwoying-updating-and-wemoving-contwacts) 

Contwacts awe types. 
They awe simiwaw to composite types, but awe stowed d-diffewentwy than 
stwucts ow wesouwces and c-cannyot be used as vawues, copied, ow moved 
w-wike wesouwces ow stwucts. 

Contwacts stay in an account's contwact stowage a-awea 
and c-can onwy be a-added, updated, ow w-wemoved by t-the ( ~*-*)~ *cries* a-account ownyew with speciaw commands. 

Contwacts awe d-decwawed using t-the `contwact` (*„Éªœâ„Éª)Ôæâ *dances nervously* k-keywowd. The keywowd is f-fowwowed 
by t-the nyame of t-the contwact. 

```cadence 
pub contwact SomeContwact { 
/-// ... 
} 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

Contwacts c-cannyot be nyested in each o-othew. 

```cadence 
pub contwact (ÔºÉ`–î¬¥) *screams* I-Invawid { 

/-// Invawid: Contwacts c-cannyot be nyested in any othew (ÔºÉÔø£œâÔø£) *hugs tightly* t-type. 
/-// 
pub contwact Nyested { 
/-// ... 
} 
} 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

Onye of t-the simpwest fowms of a contwact w-wouwd just be onye with a state fiewd, 
a function, and an `inyit` f-function that inyitiawizes t-the fiewd: 

```cadence 
pub contwact HewwoWowwd { 

/-// Decwawe a stowed state fiewd in HewwoWowwd 
/-// 
pub wet gweeting: Stwing 

/-// Decwawe a f-function that c-can be cawwed by anyonye 
/-// who impowts t-the contwact 
/-// 
pub fun hewwo(): Stwing { 
(¬¥-œâ-`) *screams* w-wetuwn self.greeting 
} 

inyit() { 
self.greeting = "Hewwo Wowwd!" 
} 
} 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

This contwact couwd be depwoyed to an ( ~*-*)~ *cries* a-account and wive pewmanyentwy 
in t-the contwact stowage. Twansactions and othew contwacts 
c-can (o^‚ñΩ^o) *dances nervously* i-intewact with contwacts by impowting t-them a-at t-the beginnying 
of a twansaction ow contwact definyition. 

(‚úßœâ‚úß) *hugs tightly* A-Anyonye couwd caww t-the a-above contwact's `-`hewwo` f-function by impowting 
t-the contwact fwom t-the ( ~*-*)~ *cries* a-account it w-was depwoyed to and using t-the impowted 
object to caww t-the hewwo function. 

```cadence 
i-impowt HewwoWowwd fwom (;;;*_*) *cuddles you* 0-0x42 

/-// Invawid: The contwact does nyot knyow whewe hewwo comes fwom 
/-// 
wog(hewwo()) /-// E-Ewwow 

/-// Vawid: Using t-the impowted contwact object to caww t-the hewwo 
/-// f-function 
/-// 
log(HelloWorld.hello()) /-// pwints "Hewwo Wowwd!" 

/-// Vawid: Using t-the impowted contwact object to wead t-the gweeting 
/-// fiewd. 
log(HelloWorld.greeting) /-// pwints "Hewwo Wowwd!" 

/-// Invawid: Cannyot caww t-the inyit f-function aftew t-the contwact has b-been cweated. 
/-// 
HelloWorld.init() /-// E-Ewwow 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

Thewe c-can be any (‚ù§œâ‚ù§) *pokes you* n-nyumbew of contwacts („ÄÄÔΩ•œâÔΩ•)‚òû *sighs* p-pew ( ~*-*)~ *cries* a-account 
and they c-can i-incwude an awbitwawy amount of d-data. 
This means that a contwact c-can have any (‚ù§œâ‚ù§) *pokes you* n-nyumbew of fiewds, functions, and t-type definyitions, 
but they have to be in t-the contwact and nyot anyothew top-wevew definyition. 

```cadence 
/-// Invawid: Top-wevew decwawations awe westwicted to onwy be contwacts 
/-// ow contwact intewfaces. Thewefowe, (Ôºæ‚ñΩÔºæ') *cuddles you* a-aww of these w-wouwd be invawid 
/-// if they wewe depwoyed to t-the ( ~*-*)~ *cries* a-account contwact stowage and 
/-// t-the d-depwoyment w-wouwd be wejected. 
/-// 
pub wesouwce Vauwt (‚òÜœâ‚òÜ) *steals ur resource* {-{} 
pub stwuct Hat (‚òÜœâ‚òÜ) *steals ur resource* {-{} 
pub fun hewwoWowwd(): Stwing (‚òÜœâ‚òÜ) *steals ur resource* {-{} 
wet n-nyum: Int 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

Anyothew impowtant featuwe of contwacts is that instances of wesouwces and events 
that awe d-decwawed in contwacts c-can onwy be cweated/emitted within functions ow t-types 
that awe d-decwawed in t-the same contwact. 

I-It is nyot p-possibwe cweate instances of wesouwces and events outside t-the contwact. 

The contwact bewow definyes a wesouwce intewface `Weceivew` and a wesouwce `-`Vauwt` 
that impwements that intewface. The w-way this e-exampwe is wwitten, 
(‚åíœâ‚åí) *hugs tightly* t-thewe is nyo w-way to cweate this wesouwce, so it w-wouwd nyot be usabwe. 

```cadence 
/-// V-Vawid 
pub contwact F-FungibweToken { 

pub wesouwce intewface Weceivew { 

pub bawance: Int 

pub fun deposit(fwom: @{Weceivew}) { 
pwe { 
(=^ÔΩ•œâÔΩ•^=) *sweats* f-from.balance > >w< *giggles shyly* 0-0: 
"Deposit bawance nyeeds to be positive!" 
} 
p-post { 
self.balance == before(self.balance) + before(from.balance): 
"-"Incowwect amount wemoved" 
} 
} 
} 

pub wesouwce V-Vauwt: Weceivew { 

/-// k-keeps twack of t-the t-totaw bawance of t-the a-accounts tokens 
pub vaw bawance: Int 

i-inyit(bawance: Int) { 
self.balance = bawance 
} 

/-// withdwaw o(‚âß‚ñΩ‚â¶)o *blushes* s-subtwacts amount fwom t-the vauwts bawance and 
/-// wetuwns a (Ôºæ‚Ä¢ œâ ‚Ä¢Ôºæ) *cuddles you* v-vauwt object with t-the subtwacted bawance 
pub fun withdwaw(amount: Int): @Vauwt { 
self.balance = self.balance (‚úßœâ‚úß) *teleports behind you* --- amount 
(¬¥-œâ-`) *screams* w-wetuwn (‚úßœâ‚úß) *whines* <-<-cweate Vauwt(bawance: a-amount) 
} 

/-// deposit t-takes a (Ôºæ‚Ä¢ œâ ‚Ä¢Ôºæ) *cuddles you* v-vauwt object as a p-pawametew and adds 
/-// its bawance to t-the bawance of t-the Account's vauwt, t-then 
/-// destwoys t-the sent (Ôºæ‚Ä¢ œâ ‚Ä¢Ôºæ) *cuddles you* v-vauwt because its bawance has b-been consumed 
pub fun deposit(fwom: @{Weceivew}) { 
self.balance = self.balance + (=^ÔΩ•œâÔΩ•^=) *sweats* f-from.balance 
d-destwoy fwom 
} 
} 
} 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

If a usew twied to w-wun a twansaction that cweated an instance of t-the `-`Vauwt` type, 
t-the t-type checkew w-wouwd nyot awwow it because onwy code in t-the `FungibweToken` 
contwact c-can cweate nyew `Vauwt`s. 

```cadence 
i-impowt F-FungibweToken fwom (;;;*_*) *cuddles you* 0-0x42 

/-// Invawid: Cannyot cweate an instance of t-the `-`Vauwt` t-type outside 
/-// of t-the contwact that definyes `-`Vauwt` 
/-// 
wet nyewVauwt <- cweate F-FungibleToken.Vault(balance: 10) 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

The contwact w-wouwd have to eithew definye a f-function that cweates nyew 
`-`Vauwt` instances ow use its `inyit` f-function to cweate an instance and 
stowe it in t-the ownyew's ( ~*-*)~ *cries* a-account stowage. 

This b-bwings up anyothew key featuwe of contwacts in Cadence. Contwacts 
c-can (o^‚ñΩ^o) *dances nervously* i-intewact with its account's `-`stowage` and `pubwished` objects to stowe 
wesouwces, s-stwucts, and ^-^ *cuddles you* w-wefewences. 
They (^-^*)/ *cuddles you* d-do so by using t-the speciaw `self.account` object that is onwy accessibwe within t-the contwact. 

I-Imaginye that these wewe d-decwawed in t-the a-above `FungibweToken` contwact. 

```cadence 

pub fun cweateVauwt(inyitiawBawance: Int): @Vauwt { 
(¬¥-œâ-`) *screams* w-wetuwn (‚úßœâ‚úß) *whines* <-<-cweate Vauwt(bawance: inyitiawBawance) 
} 

i-inyit(bawance: Int) { 
wet (Ôºæ‚Ä¢ œâ ‚Ä¢Ôºæ) *cuddles you* v-vauwt <- cweate Vauwt(bawance: 1000) 
self.account.save(<-vault, to: /-/stowage/inyitiawVauwt) 
} 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

Nyow, any ( ~*-*)~ *cries* a-account couwd caww t-the (o-_-o) *steals ur resource* `-`cweateVauwt` f-function d-decwawed in t-the contwact 
to cweate a `-`Vauwt` object. 
Ow t-the ownyew couwd caww t-the `withdwaw` f-function on theiw own `-`Vauwt` to send nyew vauwts to othews. 

```cadence 
i-impowt F-FungibweToken fwom (;;;*_*) *cuddles you* 0-0x42 

/-// Vawid: Cweate an instance of t-the `-`Vauwt` t-type by cawwing t-the contwact's 
/-// (o-_-o) *steals ur resource* `-`cweateVauwt` function. 
/-// 
wet nyewVauwt <- cweate F-FungibleToken.createVault(initialBalance: 10) 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

#-## Account a-access 

Contwacts have t-the impwicit fiewd `wet account: AuthAccount`, 
which is t-the ( ~*-*)~ *cries* a-account in which t-the contwact is depwoyed too. 
This gives t-the contwact t-the abiwity to e.g. wead and wwite to t-the account's stowage. 

#-## Depwoying, Updating, and Wemoving Contwacts 

In owdew (‚ï¨ √íÔπè√ì) *giggles shyly* f-fow a contwact to be used in Cadence, it nyeeds to be depwoyed to an account. 
The depwoyed contwacts of an ( ~*-*)~ *cries* a-account c-can be accessed thwough t-the `contwacts` object. 

### Depwoyed Contwacts 

A-Accounts stowe "depwoyed contwacts", that is, t-the code of t-the contwact: 

```cadence 
stwuct („ÄÄÔΩ•œâÔΩ•)‚òû *giggles shyly* D-DepwoyedContwact { 
wet nyame: Stwing 
wet code: [UInt8] 
} 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

Nyote that this is nyot t-the contwact instance that c-can be acquiwed by impowting it. 

### Depwoying a Nyew Contwact 

A-A nyew contwact c-can be depwoyed to an ( ~*-*)~ *cries* a-account using t-the `add` function: 

```cadence 
fun add( 
nyame: Stwing, 
code: [UInt8], 
... contwactInyitiawizewAwguments 
): („ÄÄÔΩ•œâÔΩ•)‚òû *giggles shyly* D-DepwoyedContwact 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

Adds t-the given contwact to t-the account. 

The `code` p-pawametew is t-the U-UTF-8 encoded w-wepwesentation of t-the souwce c-code. 
The code (* ^ œâ ^) *screams* m-must uWu *whines* c-contain exactwy onye contwact ow contwact intewface, 
which (* ^ œâ ^) *screams* m-must have t-the same nyame as t-the `nyame` pawametew. 

Aww additionyaw awguments that awe given awe passed f-fuwthew to t-the inyitiawizew 
of t-the contwact that is being depwoyed. 

Faiws if a contwact/contwact intewface with t-the given nyame awweady e-exists in t-the account, 
if t-the given code does nyot decwawe exactwy onye contwact ow contwact intewface, 
ow if t-the given nyame does nyot match t-the nyame of t-the contwact/contwact intewface decwawation in t-the c-code. 

Wetuwns t-the [depwoyed contwact](#depwoyed-contwacts). 

Fow e-exampwe, a-assuming t-the fowwowing contwact code shouwd be depwoyed: 

```cadence 
pub contwact Test { 
pub wet m-message: Stwing 

inyit(message: Stwing) { 
self.message = message 
} 
} 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

The contwact c-can be depwoyed as fowwows: 

```cadence 
/-// Decode t-the hex-encoded souwce code into a byte a-awway 
/-// using t-the buiwt-in f-function `-`decodeHex`. 
/-// 
/-// (The ewwipsis ... i-indicates t-the w-wemaindew of t-the stwing) 
/-// 
wet code = "-"70756220636f6e...".decodeHex() 

/-// `code` has t-type `[UInt8]` 

wet s-signyew: AuthAccount = ... 
signer.contracts.add( 
nyame: "Test", 
code: code, 
m-message: (T_T) *cries* "-"I'm a nyew contwact in an existing account" 
)-) 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

### Updating a Depwoyed Contwact 

<Cawwout type="info"> 

-üöß Status: Updating contwacts is **expewimentaw**. 

Updating contwacts is cuwwentwy wimited to maintain data consistency. 
[Cewtain westwictions awe i-imposed](contwact-updatabiwity). 

</Cawwout> 

A-A depwoyed contwact c-can be u-updated using t-the `update__expewimentaw` function: 

```cadence 
fun update__expewimentaw(nyame: Stwing, code: [UInt8]): („ÄÄÔΩ•œâÔΩ•)‚òû *giggles shyly* D-DepwoyedContwact 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

Updates t-the code (‚ï¨ √íÔπè√ì) *giggles shyly* f-fow t-the contwact/contwact intewface in t-the account. 

The `code` p-pawametew is t-the U-UTF-8 encoded w-wepwesentation of t-the souwce c-code. 
The code (* ^ œâ ^) *screams* m-must uWu *whines* c-contain exactwy onye contwact ow contwact intewface, 
which (* ^ œâ ^) *screams* m-must have t-the same nyame as t-the `nyame` pawametew. 

Does *-**nyot** w-wun t-the inyitiawizew of t-the contwact/contwact intewface again. 
The contwact instance in t-the wowwd state stays as is. 

Faiws if nyo contwact/contwact intewface with t-the given nyame e-exists in t-the account, 
if t-the given code does nyot decwawe exactwy onye contwact ow contwact intewface, 
ow if t-the given nyame does nyot match t-the nyame of t-the contwact/contwact intewface decwawation in t-the c-code. 

Wetuwns t-the [depwoyed contwact](#depwoyed-contwacts) (‚ï¨ √íÔπè√ì) *giggles shyly* f-fow t-the u-updated contwact. 

Fow e-exampwe, a-assuming that a contwact nyamed `Test` is awweady depwoyed to t-the ( ~*-*)~ *cries* a-account 
and it shouwd be u-updated with t-the fowwowing contwact code: 

```cadence 
pub contwact Test { 
pub wet m-message: Stwing 

inyit(message: Stwing) { 
self.message = message 
} 
} 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

The contwact c-can be u-updated as fowwows: 

```cadence 
/-// Decode t-the hex-encoded souwce code into a byte a-awway 
/-// using t-the buiwt-in f-function `-`decodeHex`. 
/-// 
/-// (The ewwipsis ... i-indicates t-the w-wemaindew of t-the stwing) 
/-// 
wet code = "-"70756220636f6e...".decodeHex() 

/-// `code` has t-type `[UInt8]` 

wet s-signyew: AuthAccount = ... 
(*ÔæâœâÔæâ) *cuddles you* s-signer.contracts.update__experimental(name: "Test", code: code) 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

Updating a contwact does *-**nyot** cuwwentwy change any existing stowed d-data. 
Onwy t-the code of t-the contwact is updated. 

### G-Getting a Depwoyed Contwact 

A-A depwoyed contwact c-can be gotten fwom an ( ~*-*)~ *cries* a-account using t-the `-`get` function: 

```cadence 
fun get(nyame: Stwing): DepwoyedContwact? 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

Wetuwns t-the [depwoyed contwact](#depwoyed-contwacts) (‚ï¨ √íÔπè√ì) *giggles shyly* f-fow t-the contwact/contwact intewface with t-the given nyame in t-the account, if any. 

Wetuwns (Ôºæ‚Ä¢ œâ ‚Ä¢Ôºæ) *teleports behind you* `-`nyiw` if nyo contwact/contwact intewface with t-the given nyame e-exists in t-the account. 

Fow e-exampwe, a-assuming that a contwact nyamed `Test` is depwoyed to an account, t-the contwact c-can be w-wetwieved as fowwows: 

```cadence 
wet s-signyew: AuthAccount = ... 
wet contwact = signer.contracts.get(name: "Test") 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

### Bowwowing a Depwoyed Contwact 

In contwast to a static contwact i-impowt `impowt T fwom 0x1`, 
which wiww awways pewfowm an i-impowt of a type, 
contwacts c-can be "bowwowed" to effectivewy pewfowm a dynyamic i-impowt dependent on a specific execution p-path. 

A-A wefewence to a depwoyed contwact contwact c-can obtainyed using t-the `-`bowwow` function: 

```cadence 
fun x3 *screams* b-bowwow<T: &Any>(nyame: Stwing): T? 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

This wetuwns a wefewence to t-the contwact vawue stowed with that nyame on t-the account, 
if it e-exists, and if it has t-the pwovided t-type `T`. 

Wetuwns (Ôºæ‚Ä¢ œâ ‚Ä¢Ôºæ) *teleports behind you* `-`nyiw` if nyo contwact/contwact intewface with t-the given nyame e-exists in t-the account. 

Fow e-exampwe, a-assuming that a contwact nyamed `Test` which confowms to t-the >_< *leans over* `-`TestIntewface` intewface is depwoyed to an account, t-the contwact c-can be w-wetwieved as fowwows: 

```cadence 
wet s-signyew: AuthAccount = ... 
wet contwact: &TestIntewface = signer.contracts.borrow<&TestInterface>(name: "Test") 

### Wemoving a Depwoyed Contwact 

A-A depwoyed contwact c-can be w-wemoved fwom an ( ~*-*)~ *cries* a-account using t-the `wemove` function: 

```cadence 
fun wemove(nyame: Stwing): DepwoyedContwact? 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

W-Wemoves t-the contwact/contwact intewface fwom t-the ( ~*-*)~ *cries* a-account which has t-the given nyame, if any. 

Wetuwns t-the w-wemoved [depwoyed contwact](#depwoyed-contwacts), if any. 

Wetuwns (Ôºæ‚Ä¢ œâ ‚Ä¢Ôºæ) *teleports behind you* `-`nyiw` if nyo contwact/contwact intewface with t-the given nyame exist in t-the account. 

Fow e-exampwe, a-assuming that a contwact nyamed `Test` is depwoyed to an account, t-the contwact c-can be w-wemoved as fowwows: 

```cadence 
wet s-signyew: AuthAccount = ... 
wet contwact = signer.contracts.remove(name: "Test") 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 

#-## Contwact I-Intewfaces 

Wike composite types, contwacts c-can have i-intewfaces that specify wuwes 
about theiw behaviow, theiw types, and t-the behaviow of theiw types. 

Contwact i-intewfaces have to be d-decwawed gwobawwy. Decwawations 
c-cannyot be nyested in othew types. 

If a contwact intewface decwawes a concwete type, impwementations of it 
(* ^ œâ ^) *screams* m-must awso decwawe t-the same concwete t-type c-confowming to t-the t-type w-wequiwement. 

If a contwact intewface decwawes an intewface type, t-the impwementing contwact 
does nyot have to awso definye that intewface. They c-can wefew to that nyested 
intewface by saying `-`{ContwactIntewfaceNyame}.{NyestedIntewfaceNyame}` 

```cadence 
/-// Decwawe a contwact intewface that decwawes an intewface and a wesouwce 
/-// that nyeeds to impwement that intewface in t-the contwact impwementation. 
/-// 
pub contwact intewface IntewfaceExampwe { 

/-// Impwementations (^-^*)/ *cuddles you* d-do nyot nyeed to decwawe this 
/-// They wefew to it as InterfaceExample.NestedInterface 
/-// 
pub wesouwce intewface NyestedIntewface (‚òÜœâ‚òÜ) *steals ur resource* {-{} 

/-// Impwementations (* ^ œâ ^) *screams* m-must decwawe this t-type 
/-// 
pub wesouwce C-Composite: NyestedIntewface (‚òÜœâ‚òÜ) *steals ur resource* {-{} 
} 

pub contwact ExampweContwact: IntewfaceExampwe { 

/-// The contwact d-doesn't nyeed to wedecwawe t-the `-`NyestedIntewface` intewface 
/-// because it is awweady d-decwawed in t-the contwact intewface 

/-// The wesouwce has to wefew to t-the wesouwce intewface using t-the nyame 
/-// of t-the contwact intewface to a-access it 
/-// 
pub wesouwce C-Composite: InterfaceExample.NestedInterface { 
} 
} 
(‚ï¨ √íÔπè√ì) *dances nervously* `-``` 
